<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>User Registration</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body { font-family: Arial; max-width: 400px; margin:auto; padding:20px; }
input, button { width:100%; padding:10px; margin:5px 0; }
button { background:#2d89ef; color:white; border:none; cursor:pointer; }
button:hover { background:#1b5fa7; }
button:disabled { background:#999; cursor:not-allowed; }
#msg { font-weight:bold; margin-top:10px; }
</style>
</head>
<body>

<h2>User Registration</h2>

<input type="email" id="userEmail" placeholder="Enter email" required>
<input type="password" id="password" placeholder="Password" required>
<input type="password" id="confirmPassword" placeholder="Confirm Password" required>

<button id="registerBtn" disabled>Register</button>
<p id="msg"></p>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbz7wTDOlATjivRWvlVXuN-PZO1pY5sbmboENm5pZ1q766RSNWFPMUn5S_-YrbGKNXGgfA/exec"; // Replace with deployed Apps Script URL

const userEmail = document.getElementById("userEmail");
const password = document.getElementById("password");
const confirmPassword = document.getElementById("confirmPassword");
const registerBtn = document.getElementById("registerBtn");
const msg = document.getElementById("msg");

function showMsg(text,isError=false){
  msg.textContent=text;
  msg.style.color=isError?"red":"green";
}

// Enable register button only if passwords match
function checkPasswordMatch(){
  registerBtn.disabled = !(userEmail.value && password.value && confirmPassword.value && password.value===confirmPassword.value);
}
userEmail.addEventListener("input",checkPasswordMatch);
password.addEventListener("input",checkPasswordMatch);
confirmPassword.addEventListener("input",checkPasswordMatch);

// Registration
registerBtn.addEventListener("click", async ()=>{
  if(password.value !== confirmPassword.value){ showMsg("Passwords do not match!",true); return; }

  const formData = new URLSearchParams();
  formData.append("action","register");
  formData.append("userEmail",userEmail.value);
  formData.append("password",password.value);

  registerBtn.disabled=true;
  showMsg("Registering...");

  try{
    const res = await fetch(API_URL,{method:"POST",body:formData});
    const text = await res.text();
    showMsg(text.includes("successful")?text:true,text.includes("⚠️"));
    registerBtn.disabled=false;
    if(text.includes("successful")) {
      userEmail.value=""; password.value=""; confirmPassword.value="";
    }
  } catch(err){
    showMsg("⚠️ Error: "+err.message,true);
    registerBtn.disabled=false;
  }
});
</script>

</body>
</html>
